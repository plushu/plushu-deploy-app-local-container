#!/usr/bin/env bash
set -eo pipefail; [[ -n "$PLUSHU_TRACE" ]] && set -x

app="$1"
app_dir="$PLUSHU_APPS_DIR/$app"
cidfile="$app_dir/proc/web.cid"

# kill the app when running
if [[ -f "$cidfile" ]]; then
  oldcid="$(<"$cidfile")"

  # Stop the old container (or be cool if it's already stopped)
  docker stop "$oldcid" > /dev/null || :

  # Remove the old container
  docker rm "$oldcid" > /dev/null
  rm "$cidfile"
fi
